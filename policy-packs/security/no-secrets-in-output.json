{
  "$schema": "./schema.json",
  "id": "no-secrets-in-output",
  "version": "1.0.0",
  "type": "security",
  "severity": "blocking",
  "description": "Prevent accidental exposure of secrets in execution outputs",
  "rules": [
    {
      "name": "no_api_keys",
      "condition": {
        "type": "pattern_match",
        "patterns": [
          "[a-zA-Z0-9]{32,}",
          "sk-[a-zA-Z0-9]{48}",
          "AKIA[0-9A-Z]{16}",
          "ghp_[a-zA-Z0-9]{36}"
        ],
        "scan_targets": ["output", "logs", "artifacts"]
      },
      "message": "Potential secret detected in output",
      "suggestion": "Use secret references instead of embedding values"
    },
    {
      "name": "no_private_keys",
      "condition": {
        "type": "pattern_match",
        "patterns": [
          "-----BEGIN (RSA|EC|DSA|OPENSSH) PRIVATE KEY-----"
        ],
        "scan_targets": ["output", "logs"]
      },
      "message": "Private key detected in output",
      "suggestion": "Never output private keys. Use key references."
    }
  ],
  "metadata": {
    "author": "reach-security",
    "category": "secret-management",
    "applies_to": ["all-outputs"],
    "tags": ["security", "secrets", "pii"]
  }
}
